<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link rel="icon" href="img/logo64.png">
   <link rel="stylesheet" type="text/css" href="style.css">
   <link rel="stylesheet" href="highlight/matlab.css">
   <script src="highlight/highlight.pack.js"></script>
   <script>hljs.initHighlightingOnLoad();</script>
   <title>Spin System</title>
</head>

<body>

<header>
<ul>
<li><img src="img/logo64.png", width="80%">
<li class="header-title">Hyscorean
</ul>
<p>
<br>
<ul>
<li><a href="index.html">Documentation</a>
<li><a href="references.html">Publications</a>
<li><a href="https://bitbucket.org/luisfabib/hyscorean/src/master/" target="_blank">Repository</a>
<li><a href="https://bitbucket.org/luisfabib/hyscorean/issues?status=new&status=open" target="_blank">Forum</a>
</ul>
<br>
<br>
<ul> 
</ul>
</p>
</header>

<section>

<hr>
<div class="functitle">Defining the Spin System</div>
<hr>

<p>
In contrast to EasySpin in Hyscorean the spin system can be defined via the GUI and allows the user to modify it without the need to start the module anew. This can be done via the <code>(…)</code> button next to the <code>System</code> tag. The current system’s nuclei considered are displayed next to this button as a blue text. 
</p>

<center>
<img src= "img/fittingspectra3.png",  width="75%", class="center">
</center>

<p>
By pressing the button, a new window is opened which allows the user to modify a text box where the EasySpin <code>Sys</code> and <code>Vary</code> structures can be constructed using the usual MATLAB/EasySpin notation. The spin system is defined by the <code>Sys</code> structure and the fitting parameters are given in <code>Vary</code>. For further details, please refer to the <a href="http://easyspin.org/easyspin/documentation/"> EasySpin documentation </a>.
<p>

<hr>
<p>
NOTE: <br>
The <code>Exp</code> and <code>Opt</code> variables usually required by EasySpin for simulations are automatically constructed from the experimental parameters in the measurement files and do not need to be constructed by the user. The user can, however, define further fields on those structures from the same window.
</p>
<hr>

<p>
By pressing the <code>OK</code> button, the window is closed, and the input is compiled. Should there be any errors in the spin system definition, the program will recognize this and prompt an error window and request the user to check the input again. Once the input has been compiled without errors, the new <code>Vary</code> structure parameters will be updated on the <code>Parameters</code> table immediately. 
</p>

<center>
<img src= "img/fittingspectra4.png",  width="75%", class="center">
</center>

<p>
The table rows indicate the different parameters of the spin system which are to be fitted and the columns indicate the following properties: 
<ul>
&emsp;	<code>Name</code>	Descriptor of the parameter to be fitted as defined in the input <br>
&emsp;	<code>Best</code> 	Value of the parameter in the best fit spectrum <br>
&emsp;	<code>Current</code> 	Value of the parameter for the current iteration spectrum <br>
&emsp;	<code>Center</code> 	Value given to the parameter in the <code>Sys</code> variable <br>
&emsp;	<code>Vary</code>	Variation range of values which the parameter can adopt  <br>
</ul>
Next to this table a set of buttons can be pressed to Invert the check boxes in the table, select them All or None. 
</p>

<p>
The user has also the option to pass the spin system programmatically from MATLAB scripts as an input to the <code>launch_Hyscorean_fit</code> function, which then will pass the <code>Sys</code> and <code>Vary</code> as variables to Hyscorean’s fit module. This can be done by passing the <code>Sys</code> and <code>Vary</code> structures as fields of the structure which is given as input:
</p>

<pre class="matlab">
Sys.Nucs = '15N,14N';                                                         
Sys.g = [5.88 2 0.001];                                                       
Sys.A = [5.5 5.5 18.5; 20 20 20];                                             
                                                                              
Vary.A =  [8 8 5; 5 4 6];                                                     
Vary.g = [2 2 0; 5 2 1];               
 
Input.Sys = Sys;
Input.Vary  = Vary;
 
launch_Hyscorean_fit(Files,Path,Input
 </pre>
 <center>
<img src= "img/fittingspectra14.png",  width="40%">
</center>

<hr>
<p>
NOTE: <br>
Hyscorean stores the text used for the spin system definition as a MATLAB preference. This means that once the program is closed, the next time it is opened the text in the window <>(and thus the spin system definition) will be exactly the same as when it was closed. 
</p>
<hr>

<!-- =========================================================== -->
<hr>
<a href="fittingspectra.html" class="previous", align="left">&laquo; Previous</a>
&emsp;
<a href="startstopfit.html" class="next", style="text-align:right">Next &raquo;</a>
<hr>
</section>


<footer>
Hyscorean Documentation - Luis Fábregas Ibáñez  2019 - ETH Zurich - Released under the GNU Lesser General Public License (LGPL 3.0).
</footer>

</body>
</html>
